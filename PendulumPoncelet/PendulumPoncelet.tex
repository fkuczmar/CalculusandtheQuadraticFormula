\documentclass{ximera}
\title{Short Version: Poncelet's Porism and Simple Pendulums}

\newcommand{\pskip}{\vskip 0.1 in}

\begin{document}
\begin{abstract}
We investigate the families of \emph{isochronous chords} of a pendulum motion. The chords of each family subtend arcs of equal time.
\end{abstract}
\maketitle

%Think of a simple pendulum, and you might picture a mass oscillating at the end of a string. But this paper is mostly about revolving pendulums. You can imagine instead a mass attached to a weightless rod or a small bead that slides around a circluar wire, either launched with sufficient speed to repeatedly revolve around its circular path. 

%Think of a simple pendulum, and you might picture a mass oscillating at the end of a string. But imagine instead a mass attached to a weightless rod or a small bead that slides around a circluar wire, either launched with sufficient speed to repeatedly revolve around its circular path. Now construct chords around the circular path of this revolving pendulum that bisect the period in the sense that the pendulum traveses the two arcs subtended by each chord in equal times. One such chord is the vertical diameter. Another is horizontal, but where? And what can we say about the other bisecting chords?

Think of a simple pendulum and you probably picture a mass oscillating at the end of a string. But imagine instead a mass attached to a weightless rod launched from its low point with sufficient speed to repeatedly revolve around its circular path. Now construct chords around the path of this revolving pendulum that bisect the period - the pendulum should traverse the arcs subtended by each chord in half the period. One such chord is the vertical diameter. Another is horizontal. But what can we say about the other bisecting chords?

Suppose, as in the exploration below, we are given the horizontal chord that bisects the period. How can we draw other bisecting chords?

\begin{exploration}
The horizontal chord below bisects the period of a revolving pendulum. How can we draw other bisecting chords? What can we say about the family of all such chords?

\begin{onlineOnly}
    \begin{center}
\desmos{x5fzsfvxdb}{450}{600}  
\end{center}
\end{onlineOnly}

\href{https://www.desmos.com/calculator/x5fzsfvxdb}{Revolving Pendulum Opening Problem 1}

\end{exploration}


More generally, how can we draw other families of \emph{isochronous chords}, where the pendulum swings through the quicker arc subtended by the chords in some fixed fraction of the period?  And what can we say about the curve these chords might envelope?

The exploration below shows an example. Given the horizontal chord (through $F$) that bisects the period and a horizontal chord $\overline{XY}$, how can we construct other chords in the same isochronous family as $\overline{XY}$. And what can we say about the envelope of all such chords?

%Or pick some fraction of the period of revolution. How can we draw a chord that subtends an arc traversed in this fraction of the period? What can we say about all such chords and the curve they envelope?



\begin{exploration}
What can we say about the isochronous family generated by the horizontal chord $\overline{XY}$ for the revolving pendulum below? The horizontal chord through $F$ bisects the motion.

\begin{onlineOnly}
    \begin{center}
\desmos{1kyfdn6yyc}{450}{600}  
\end{center}
\end{onlineOnly}

\href{https://www.desmos.com/calculator/1kyfdn6yyc}{Revolving Pendulum Opening Problem 2}

\end{exploration}

It turns out that these questions are closely related to a proof of Poncelet's porism. % classical theorem from projective geometry. %, or rather to a proof of that theorem.



%All these questions are related to Poncelet's Porism. 

\section*{Poncelet's Porism}

%A spotlight in a circular dance hall rotates at a constant rate as the light beam sweeps around the wall. Where is the light beam when its speed is increasing at the fastest rate?

%Let $R$ be the radius of the dance hall and $a$ the distance between the spotlight and the room's center. Let $\omega$ be the rotation rate (in rad/sec).

%Draw a smaller circle (${\cal C}_2$) inside a larger one (${\cal C}_1$). Then pick a point $P_0$ on ${\cal C}_1$ and construct a polygonal path $P_0 P_1 P_2 \ldots$ of chords $\overline{P_0P_1}$, $\overline{P_0P_1}, \ldots$ tangent to ${\cal C}_2$ running counterclockwise around ${\cal C}_1$. Most likely the path never closes.  But if by chance it does, then it was not because you made a fortunate choice of $P_0$ but because you were lucky in choosing the initial confuguation of circles. The  path then would close for any starting point and do so in the same way. The figure below shows a configuration of ${\cal C}_1$ and ${\cal C}_2$ for which the path closes with five segments and forms a pentagram circumscribed about ${\cal C}_2$.

Draw a circle (${\cal C}_2$) inside a larger one (${\cal C}_1$). Then pick a point $P_0$ on ${\cal C}_1$ and construct a polygonal path $P_0 P_1 P_2 \ldots$ of chords $\overline{P_0P_1}$, $\overline{P_0P_1}, \ldots$ tangent to ${\cal C}_2$ running counterclockwise around ${\cal C}_1$. Most likely the path never closes.  But if so, it was not because you chose a fortuitous starting point but because you were lucky in choosing the initial confuguation of circles. Poncelet's porism says the path would then close for any starting point (a similar statement holds for two nested ellipses). The figure below shows a configuration of ${\cal C}_1$ and ${\cal C}_2$ for which any path closes with five segments and forms a pentagram circumscribed about ${\cal C}_2$.

%This fact is the circular version of Poncelet's Porism (a similar statement holds for two nested ellipses). The only proof I've seen relies on defining a new metric around ${\cal C}_1$, one with the property that all chords tangent to ${\cal C}_2$ subtend equal arclengths of ${\cal C}_1$. 

One way to prove the circular version of Poncelet's porism is to define a metric around ${\cal C}_1$ with the property that all chords tangent to ${\cal C}_2$ subtend equal arclengths of ${\cal C}_1$. Defining this metric is like wrapping a number line around ${\cal C}_1$ as illustrated in the figure below. There the tick marks are spaced at equal intervals, say one unit apart, and each chord subtends a shorter arc of $8$ units. Since ${\cal C}_1$ has circumference $24$ units, every path (not just the one shown) closes with three chords and forms a triangle circumscribed about ${\cal C}_2$.  

\begin{exploration}
Move the slider $\theta_1$ to change the path and slider $a$ to change the distance between the centers of ${\cal C}_1$ and ${\cal C}_2$.
 
\begin{onlineOnly}
    \begin{center}
\desmos{wzctareiln}{450}{600}  
\end{center}
\end{onlineOnly}

\href{https://www.desmos.com/calculator/wzctareiln}{Poncelt Metric with Jacobi Functions}

\end{exploration}

In the example below, each chord subtends $2/5$ of the circumference in the new metric. So every path closes after five segments and forms a pentagram circumscribed about ${\cal C}_2$. More generally, when the chords subtend an arclength equal to a rational multiple $\lambda = q/p$ ($p$ and $q$ relatively prime positive integers) of the circumference, the path closes with $p$ chords and forms a $\{p/q \}$ star polygon. But when the ratio $\lambda = (\text{arclength subtended by chords : circumference})$ is irrational the path never closes.

\begin{exploration}
\begin{onlineOnly}
    \begin{center}
\desmos{qco4rghhfi }{450}{600}  
\end{center}
\end{onlineOnly}

\href{https://www.desmos.com/calculator/qco4rghhfi}{Pentagram}

\end{exploration}

We can better relate the proof of Poncelet's Porism to revolving pendulums by replacing the distance metric around ${\cal C}_1$ with a time metric. So imagine instead a motion around ${\cal C}_1$ that traverses the quicker arcs subtended by the tangent chords in equal times. A priori, it's not clear such an \emph{equal-time} motion exits, but if so, we would have a proof of Poncelet's Porism. Supposing a period of one second, every path would form a $\{p/q \}$ star polygon for a motion that takes $\lambda = p/q$ seconds to traverse each quicker (or slower) arc. And paths with irrational $\lambda$ would never close. 

%Figure ?? below is the key to describing the equal-time motions. Imagine a tangent chord $\overline{PP^\prime}$ rotating through the differential angle $d\phi$ as $P$ and $P^\prime$ traverse the respective arclengths $ds$, $ds^\prime$. These are the ones that traverse the differ

To describe the equal-time motions, consider first the degenerate case when ${\cal C}_1$ is a point $A$ and Poncelet's Porism is trivial. One choice for an equal-time motion is a motion that rotates about $A$ at a constant rate.  But there are many others. %others, and one of these has a speed function that is simpler than all the others. %But there are many others. %Indeed we have almost have almost complete freedom in defining an equal-time motion by choosing a function $\omega = f(\phi)$, $0\leq \phi \leq \pi$


Because the equal-time condition relates only the times to traverse arcs subtended by chords through $A$, we have the freedom to arbitrarily define the speed of the motion on either of the two arcs subtended by one such chord. This choice, assumed to be continuous, determines the speed along the other arc. The motion there is traced by the other end of the chord $\overline{PP^\prime}$ through $A$ as $P$ follows its arbitrarily defined motion along the chosen arc. This is because from any initial position of the chord, the points $P$ and $P^\prime$ arrive simultaneously at the other's starting point.

%Suppose for example, we choose a continous motion 
%\[
%   v_P = f(\phi) \, , 0\leq \phi \leq \pi , 
%\]
%along the semicircle to the right of the vertical diameter $ED$. To extend this to an equal-time motion around the circle, imagine $P$ moving along the semicircle with this motion and let $\overline{PP^\prime}$ be the chord through $A$. Then $P^\prime$ moves with the other half of the equal-time motion. This is simply because from any initial position of the chord, the points $P$ and $P^\prime$ arrive simultaneously at the other's starting point.


To describe a speed function, we relate the speeds of $P$ and $P^\prime$ to the rotation rate of $\overline{PP^\prime}$. For this, let $ds$ and $ds^\prime$ be the differential arclengths  traced respectively by $P$ and $P^\prime$ as $\overline{PP^\prime}$ turns through the angle $d\phi$. From the expression for arclength in polar coordinates,  
\begin{equation}
   ds =  \sqrt{(\rho \, d\phi)^2 + d\rho^2}   =   (\rho \, d\phi) \csc \alpha ,   \label{Eq:ArcLength}
\end{equation}
where $\rho = AP$ is the distance from $A$ to $P$ and $\alpha$ the acute angle $\overline{AP}$ makes with ${\cal C}_1$ at $P$. 

Dividing both sides by the differential time (in seconds) it takes $\overline{PP^\prime}$ to turn through the angle $d\phi$ gives the speed of $P$ as
\begin{equation}
    v_P = \frac{ds}{dt} = \omega \rho \csc \alpha ,  \label{Eq:ConstantRate}
\end{equation}
where $\omega  = d\phi/dt$ is the rotation rate (not necessarily constant) of $\overline{PP^\prime}$.

Similarly, because $\overline{AP^\prime}$ cuts ${\cal C}_1$ at the same angle $\alpha$ and \emph{$P^\prime$, $P^\prime$ take the same time to traverse their respective arclengths}, $P^\prime$ has speed
\begin{equation}
   v_{P^\prime} =   \omega \rho^\prime  \csc \alpha ,  \label{Eq:ArcLength2}
\end{equation}
where $\rho^\prime = AP^\prime$.


Thus,
\begin{equation}
    \frac{v_P}{\rho} = \frac{v_{P^\prime}}{\rho^\prime} .  \label{Eq:SpeedCondition}
\end{equation}

So if 
\[
  v_P = f(\phi) \, , 0\leq \phi \leq \pi , 
\]
is an arbitrary but continuous speed function around the right arc of the vertical diameter $\overline{CD}$  through $A$ and $\phi = \angle CAP$, the function
\[
   v_P = v(\phi)  = 
\begin{cases}
          f(\phi) \, , 0\leq \phi \leq \pi \\
         \frac{\rho (\phi + \pi)}{\rho (\phi)} f(\phi-\pi) \, , \pi < \phi < 2\pi ,
\end{cases}
\]
describes an equal-time motion. %Here $\phi = \angle CAP$.

To make this motion continuous at $\phi=0$ and $\phi= \pi$, we should make sure $P$ arrives at $D$ (when $\phi = \pi$) at the same speed at whic $P^\prime$ leaves $D$ (when $\phi=0$).  That is, we should choose $f$ so that 
\[
   f(\pi) =  \frac{\rho(\pi)}{\rho(0)} f(0) .
\]

Equivalently, when ${\cal C}_1$ is a point we could choose an arbitrary positive, continous function
\[
     \omega = g(\phi), 0 \leq \phi \leq 2\phi ,
\]
with period $\pi$ for the rotation rate of $PP^\prime$. Then the speed function
\[
    v_P = \omega \rho \csc\alpha % = \omega \rho \left( \frac{PP^\prime}{2R} \right)
\]
describes an equal-time motion.

Letting $\omega_0$ be the rotation rate when $\overline{PP^\prime}$ is vertical and defining $\omega = \omega_0 \sin\alpha$ % = \left( \frac{\omega_0}{2R} \right) PP^\prime ,
gives a simpler speed function than does a constant rotation rate. If ${\cal C}_1$ has radius $R$, $A$ has coordinates $(0,a)$, and $\theta = \angle EOP$ in the figure below, then $P$ has speed
\begin{align*}
   v_P &= \omega_0 \rho \\
          &= \omega_0  \sqrt{R^2 + a^2 + 2aR\cos\theta} 
\end{align*}
and $\overline{PP^\prime}$ rotation rate
\begin{equation}
   \omega = \omega_0 \sin\alpha = \left( \frac{\omega_0}{2R} \right) PP^\prime  \label{Eq:PendulumMotion}
\end{equation}
proportional to $PP^\prime$.

\begin{onlineOnly}
    \begin{center}
\geogebra{wenuyqer}{450}{600}  
\end{center}
\end{onlineOnly}



\begin{exploration}
The animation below shows an equal-time motion (\ref{Eq:PendulumMotion}) with speed proportional to $\rho$.
\begin{onlineOnly}
    \begin{center}
\desmos{g2o1szpkh5}{450}{600}  
\end{center}
\end{onlineOnly}

\href{https://www.desmos.com/calculator/g2o1szpkh5}{Poncelelts Porism Disco Dancing}
\end{exploration}


\iffalse
**********************************************************************
We can also express an equal-time motion in the form
\[
      v_P = v(\phi) = \omega_0 \rho (\phi) h(\phi) ,
\]
for some some constant $\omega_0$ with units rad/sec and some contiuous scaling function $h$ with period $\pi$. Requiring $h(0)=1$, we can interpret $\omega_0$ as the rotation rate of chord $\overline{PP^\prime}$ when it is the vertical diameter through $A$.


Taking $h(\phi) = \csc \alpha$ gives the motion that rotates about $A$ at the constant rate of $\omega_0$ rad/sec. But a simpler choice would have been to take $h(\phi)=1$ to get the equal-time motion                  %what we'll call the \emph{pendulum} constant-time motion
\begin{equation}
   v_P =   v(\phi) = \omega_0 \rho(\phi) \label{Eq:PendulumMotion} 
\end{equation}
with speed proportional to the distance $\rho(\phi) = AP$. This motion has a rotation rate %the rotation rate $\omega = \omega(\phi)$ is
\begin{align*}
     \omega &= \frac{v_P}{\rho (\phi) \csc \alpha} \\
                 &= \omega_0 \sin\alpha  \\
                  & = \omega_0 \frac{2R \sin\alpha}{2R}  \\
                  &=  \left( \frac{\omega_0}{2R}\right) PP^\prime 
\end{align*}
proportional to the length of chord $\overline{PP^\prime}$.

Dividing both sides of (\ref{Eq:ArcLength}) by the differential time (in seconds) it takes $\overline{PP^\prime}$ to turn through the angle $d\phi$ tells us that 
\begin{equation}
    v_P = \frac{ds}{dt} = \omega \rho (\phi) \csc \alpha ,  \label{Eq:ConstantRate}
\end{equation}
where $\omega  = d\phi/dt$ is the rotation rate (not necessarily constant) of $\overline{PP^\prime}$.

**************************************************************************************************
\fi




\begin{exploration}
The animation below shows two equal-time motions, one with speed proportional to $\rho$ and rotation rate proportional to $PP^\prime$ (\ref{Eq:PendulumMotion}), the other with a constant rotation rate (\ref{Eq:ConstantRate}). 
\begin{onlineOnly}
    \begin{center}
\desmos{xifdeg3wsq}{450}{600}  
\end{center}
\end{onlineOnly}

\href{https://www.desmos.com/calculator/xifdeg3wsq}{Poncelets Porism vs Constant Rotation Rate}

\end{exploration}


%In the general case when ${\cal C}_2$ is a circle of radius $r$ centered at $(0,a)$ as in the figure below, the motion (\ref{Eq:PendulumMotion}) with speed proportional to the distance $\rho = BP$ from $P$ to ${\cal C}_1$ (the length of segment $\overline{BP}$ tangent to ${\cal C}_2)$ also has the equal-time property. This is because

%The general case when ${\cal C}_2$ is a circle of radius $r$ is similar. Here a motion is equal-time if and only if the endpoints of any chord $\overline{PP^\prime}$ tangent to ${\cal C}_2$ traverse their respective arclengths in equal-times. 


%centered at $(0,a)$ as in the figure below, the motion (\ref{Eq:PendulumMotion}) with speed proportional to the distance $\rho = BP$ from $P$ to ${\cal C}_1$ (the length of segment $\overline{BP}$ tangent to ${\cal C}_2)$ also has the equal-time property. This is because


In the general case when ${\cal C}_2$ is a circle the key points are the same. %Suppose chord $\overline{PP^\prime}$

\pskip

(a) Let chord $\overline{PP^\prime}$ be tangent to ${\cal C}_2$ at $B$ and let $\rho$, $\rho^\prime$ be the respective distances $BP$ and $BP^\prime$. Then as $\overline{PP^\prime}$ turns through the angle $d\phi$, its endpoints $P$ and $P^\prime$ traverse their respective arclengths (see (\ref{Eq:ArcLength})) and (\ref{Eq:ArcLength2})
\begin{equation}
     ds = \rho \csc \alpha \, d\phi \,\,\,\,\, \text{ and } \,\,\,\, ds^\prime = \rho^\prime \csc \alpha \, d\phi  \label{Eq:ArcLengths2}
\end{equation}
in equal times.

(b) A motion around ${\cal C}_1$ is equal-time if and only if (see (\ref{Eq:SpeedCondition}))
\[
     \frac{ds}{v_P} = \frac{ds^\prime}{v_{P^\prime}}  \text{ or equivalently } \frac{\rho}{v_P} = \frac{\rho^\prime}{v_{P^\prime}} 
\] 
for all chords $\overline{PP^\prime}$ tangent to ${\cal C}_1$.


%As chord $\overline{PP^\prime}$ tangent to ${\cal C}_2$ at $B$ turns through the angle $d\phi$, its endpoints $P$ and $P^\prime$ traverse their respective arclengths (\ref{Eq:ArcLength}) and (\ref{Eq:ArcLength2})
%\[
%     ds = \rho \csc \alpha \, d\phi \,\,\,\,\, \text{ and } \,\,\,\, ds^\prime = \rho^\prime \csc \alpha \, d\phi,
%\]
%where $\rho = BP$ amd $\rho^\prime =  BP^\prime$.

%(b) A motion is equal-time if and only if $P$ and $P^\prime$ a traverse these arclengths in equal times or equivalently that their speeds are proportional to the distances $\rho = BP$ and $\rho^\prime = BP^\prime$. %a necessary and sufficient condition for a motion to be equal-time is that $P$ and $P^\prime$ traverse these arclengths in equal times.

\begin{onlineOnly}
    \begin{center}
\desmos{nmxgwpl2fo}{450}{600}  
\end{center}
\end{onlineOnly}

\pskip

So if we knew \emph{apriori} that a particular configuration of ${\cal C}_1$, ${\cal C}_2$ forced each path of tangent chords to close, say with three segments, we could arbitrarily define an equal-time motion along the outer arc subtended by a chord $\overline{CD}$ of an arbitrary triangle $\Delta CDE$ circumscribed about ${\cal C}_2$. Then the motions at points $P^\prime$ $P^{\prime\prime}$ of the outer arcs subtended respectively by $\overline{DE}$ and $\overline{DE}$ would be determined by the conditions that
\[
       \frac{\rho}{v_P} = \frac{\rho^\prime}{v_{P^\prime}} = \frac{\rho^{\prime\prime}}{v_{P^{\prime\prime}}},
\]
where $\Delta PP^\prime P^{\prime\prime}$ is circumscribed about ${\cal C}_1$ in the same sense as $\Delta CDE$ (see Figure ????).

But if we knew nothing about the particular configuration of circles, the only possible choice for an equal-time motion would be
\begin{equation}
    v_P =  v_P(\phi) = \omega_0 \rho(\phi)   \label{Eq:EqualTime8}
\end{equation}
with speed proportional to the distance $\rho(\phi) = PB$. The explorations below shows two such motions.

\begin{exploration}
\begin{onlineOnly}
    \begin{center}
\desmos{l7oadgwyva}{450}{600}  
\end{center}
\end{onlineOnly}

\href{https://www.desmos.com/calculator/l7oadgwyva}{Poncelt Metric with Jacobi Functions 3} %   q16ify3gtm
\end{exploration}


\begin{exploration}
\begin{onlineOnly}
    \begin{center}
\desmos{hm5zop04ob}{450}{600}  
\end{center}
\end{onlineOnly}

\href{https://www.desmos.com/calculator/hm5zop04ob}{Poncelt Metric with Jacobi Functions 2}
\end{exploration}

To prove that the motion (\ref{Eq:EqualTime8}) is indeed equal-time, we first need to show (\ref{Eq:ArcLengths2}) in part (a) above holds. For this, let $\phi$ be the angle radius $\overline{AB}$ makes with the horizontal and $\alpha$ the acute angle $\overline{PP^\prime}$ makes with ${\cal C}_1$. Then 
\[
      \overrightarrow{AB} = \langle r\cos \phi, r\sin\phi \rangle
\]
and
\begin{align*}
    \overrightarrow{p} &= \overrightarrow{AP}   \\
                                &= \overrightarrow{AB}+\overrightarrow{BP} \\
                                &= r\langle \cos \phi, \sin \phi \rangle + \rho \langle \sin\phi, -\cos\phi  \rangle . 
\end{align*}
So
\[
    d\overrightarrow{p} = (d\rho - r \, d\phi ) \langle \sin \phi, -\cos \phi \rangle+ \rho \langle \cos\phi, \sin\phi \rangle \, d\phi .
\]
The above resolves the component of $P$'s displacement into two components, the first parallel to $\overline{PP^\prime}$, the second normal to $\overline{PP^\prime}$. So, as $\overline{PP^\prime}$ turns through the angle $d\phi$, $P$ traverses the differential arclength
\[
   ds = |d\overrightarrow{p}| = |  \rho \langle \cos\phi, \sin\phi \rangle \, d\phi |    = \rho \csc \alpha \, d\phi
\]
along ${\cal C}_1$. 

As for part (b), by subtraction (ie. differentiation)  $P$ and $P^\prime$ traverse their respective differential arclengths for an equal-time motion in equal times. And the converse holds by addition (ie. integration). For a formal proof, it helps to regard $\rho = BP$ as a function $\rho = g(\theta)$ of the central angle $\angle EOP$ (see Figure ?). Then $ds = R \, d\phi$ and with $\theta^\prime = k(\theta)$ the central angle $\angle EOP^\prime$, the time for the motion to traverse the arc subtended by $\overline{PP^\prime}$ is
\[
  T(\theta) =  \int_\theta^{k(\theta)} \frac{R\, d\theta^*}{\omega_0 g(\theta^*)}.
\]
Then
\begin{align*}
  \frac{d}{d\theta} \int_\theta^{k(\theta)} \frac{R\, d\theta^*}{\omega_0 g(\theta^*)} &= \frac{R}{\omega_0}\left(   \frac{k^\prime(\theta)}{g(k(\theta))} - \frac{1}{g(\theta)}        \right) = 0
\end{align*}
if and only if 
\[
    k^\prime(\theta) = \frac{g(k(\theta))}{g(\theta)} = \frac{v_{P^\prime}}{v_P}.
\]
But by part (a) above
\[
   k^\prime(\theta) = \frac{v_{P^\prime}}{v_P}   =  \frac{d\theta^\prime}{d\theta} =   \frac{\rho^\prime}{\rho}.
\]
and the motion (\ref{Eq:equalTime8}) is an equal-time motion.


So the existence of the equal-time function
\[
      v_P = \omega_0 \rho
\]
with speed proportional to the distance $\rho = BP$ proves Poncelet's porism. But more importantly for us is that this function is related to the motion of a revolving pendulum. To understand how, we should first express the speed as a function of central angle $\theta = \angle EOP$. Using the law of cosines in $\Delta AOP$ where $\angle AOP = \pi - \theta$, we have
\[
  AP^2  = R^2 + a^2 + 2aR \cos \theta .
\]
Then
\begin{align*}
   \rho  &=  \sqrt{AP^2 - r^2}         \\  \notag
          & = \sqrt{R^2 + a^2 -r^2 + 2aR \cos \theta}  \\ \notag
          &=   \sqrt{(R+a)^2 - r^2 - 4aR\sin^2 (\theta/2)} .
\end{align*}
and
\begin{equation}
      v_P = g(\theta) = \omega_0  \sqrt{(R+a)^2 - r^2 - 4aR\sin^2 (\theta/2)}.  \label{Eq:PropSpeed}
\end{equation}

Our next step is to compute the speed function for a simple pendulum.








\iffalse
To find an expression for the speed of such a motion, consider more generally a motion traced by a point $P$ that rotates about $A$ with rate $\omega = f(\theta)$ rad/sec a function of position (central angle $\angle EOP$). Then as $\overline{AP}$ turns through the differential angle $d\phi$, $P$ traverses the differential arclength
\[
   ds =  \sqrt{(\rho \, d\phi)^2 + d\rho^2}   =   (\rho \, d\phi) \csc \alpha ,
\]
the second equality because $\alpha$ is then angle opposite the leg with length $\rho \, d\phi$ in the right triangle with other leg $d\rho$ and hypotenuse $ds$. Dividing both sides by the differential time $dt$ gives the speed of $P$,
\[
     v_P  = \omega \rho \csc \alpha .
\]


%Then the speed at a point $P$ of the path is  
%\[
%      v_P = \omega \rho \csc \alpha,
%\]
%where $\rho = AP$ is the distance from $A$ to $P$ and $\alpha$ is the acute angle $\overline{AP}$ makes with the circle at $P$. This follows from the expression
%\[
%   ds =  \sqrt{(\rho \, d\phi)^2 + d\rho^2}   =   (\rho \, d\phi) \csc \alpha
%\]
%for the differential arclength in polar coordinates. As $\overline{AP}$ turns through the differential angle $d\phi$, the product $\rho \,d\phi$ measures the component of $P$'s displacement perpendicular to the polar radius $\overline{AP}$ and $d\rho$ the component parallel to $\overline{AP}$. The angle $\alpha$ is opposite the leg with $\rho \, d\phi$ in the right triangle with other leg $s\rho$ and hypotenuse $ds$.



%To describe an equal-time motion when ${\cal C}_1$ is a point $A_0$ (and Poncelet's porism is trivially true) is easy. Just let the motion rotate about $A_0$ at a constant rate.



%To find an expression for the speed of a general motion, let $\omega$ (in rad/sec) be the rate of rotation (not necessarily contant. The the speed at a point $P$ of the path is
%\[
%      v_P = \omega \rho \csc \alpha,
%\]
%where $\rho = AP$ is the distance from $A$ to $P$ and $\alpha$ is the angle $\overline{AP}$ makes with the circle at $P$. This follows from the expression
%\[
%   ds =  \sqrt{(\rho \, d\phi)^2 + d\rho^2}   =   (\rho \, d\phi) \csc \alpha
%\]
%for the differential arclength in polar coordinates. As $\overline{AP}$ turns through the differential angle $d\phi$, the product $rho , d\phi$ measures the component of $P$'s displacement perpendicular to the polar radius $\overline{AP}$ and $d\rho$ the component parallel to $\overline{AP}$. The angle $\alpha$ is opposite the leg with $\rho \, d\phi$ in the right triangle with other leg $\rho \, d\phi$ and hypotenuse $ds$.


%traversed by $P$ as $\overline{AP}$ turns through the angle $d\phi$ (since the angle $\alpha$ is opposite the leg with $\rho \, d\phi$ in the right triangle with other leg $\rho \, d\phi$ and hypotenuse $ds$).


%To see why, note that as $\overline{AP}$ turns through the differential angle $d\phi$, $P$ traverses the differential arclength
%\[ 
%      ds = (\rho \, d\phi) \csc \alpha .
%\]
%This is because $\rho , d\phi$ measures the component of $P$'s displacement perpendicular to $\overline{AP}$ and in the differential right triangle with legs $d\rho$, $\rho \, d\phi$, and hypotenuse $ds$, the angle $\alpha$ is opposite the leg with length $\rho \, d\phi$.




%To express the speed $v$ of the motion in terms of the counterclockwise angle $\phi = \angle EOP$ from the vertical to segment $OP$ below


%Instead of defining a new metric around ${\cal C}_1$, imagine instead a point moving around ${\cal C}_1$ in such a way that it traverses the shorter arcs subtended by the tangent chords in equal times. 

With $\theta$ the measure of the central angle $\angle EOP$ that $\overline{OP}$ makes with the downward vertical, we have
\[
  \rho = \sqrt{R^2 + a^2 + 2ar \cos \theta}
\]
and 
\[
    v_P = \omega \sqrt{R^2 + a^2 + 2ar \cos \theta} \csc \alpha .
\]

To express $\csc\alpha$ in terms of $\theta$, use the law of sines in $\Delta AOP$ where $\angle APO = \pi/2 - alpha$. This gives
\[
    \frac{\sin\theta}{\rho} = \frac{\cos\alpha}{a}.
\]

\fi

Here are a few animiations of equal-time motions. The graphs show the reciprocal of the speed functions as function of the angle $\theta$. The shaded areas under each graph, proptional to the times to traverse the arclengths subtended by the sides of the polygon, are all equal.

\begin{exploration}

\begin{onlineOnly}
    \begin{center}
\desmos{0aihemcv0o}{450}{600}  
\end{center}
\end{onlineOnly}

\href{https://www.desmos.com/calculator/0aihemcv0o}{Poncelts Porism Triangles}

\end{exploration}


\begin{exploration}

\begin{onlineOnly}
    \begin{center}
\desmos{pua4ogjcmr}{450}{600}  
\end{center}
\end{onlineOnly}

\href{https://www.desmos.com/calculator/pua4ogjcmr}{Poncelts Porism Quadrilaterals}


\end{exploration}


\begin{exploration}
\begin{onlineOnly}
    \begin{center}
\desmos{lwbypn9rje}{450}{600}  
\end{center}
\end{onlineOnly}

\href{https://www.desmos.com/calculator/lwbypn9rje}{Poncelets Porism and Jacobi}

\end{exploration}


\section*{Revolving Pendulums}
The motion of a pendulum is governed by the conservation of mechanical energy. Here's a proof that works for a small bead sliding without friction along a smooth track in a uniform gravitational field.

Let $\overrightarrow{j}$ be the unit vector pointing in the direction opposite the gravitational field. Let $\overrightarrow{v}$ be the velocity of the sliding mass and $O$ a random point in the plane of motion. We measure the graviational potential energy relative to the horizontal line through $O$. Let $\overrightarrow{r} = \overrightarrow{OP}$ be the position of the mass relative to $O$.

Then the mechanical energy of the system at any instant is
\[
        E = \frac{1}{2}m \overrightarrow{v} \cdot \overrightarrow{v} + mg \overrightarrow{r}\cdot \overrightarrow{j} .
\] 
Differentiating with respect to time,
\[
     \frac{dE}{dt} = m\overrightarrow{v} \cdot \overrightarrow{a}  + m g \overrightarrow{v} \cdot \overrightarrow{j} .
\]
Now there are two forces acting on the mass, the force of gravity $-mg\overrightarrow{j}$  and the force of the track $m \overrightarrow{a_n}$. Hence, 
\[
   m\overrightarrow{a} = m \left(    -g\overrightarrow{j} + \overrightarrow{a_n}   \right) . 
\]
And since $\overrightarrow{v}\cdot \overrightarrow{a_n}=0$,
\[
    \frac{dE}{dt} = -mg \overrightarrow{v}\cdot \overrightarrow{j} + mg \overrightarrow{v} \cdot \overrightarrow{j} = 0.
\]


Now moving on to the main point, let $R$ be the pendulum's radius, $v_0$ be the speed of the pendulum at its low point, and $v_P$ its speed at angular displacement $\theta$. Then
\begin{align*}
    v_P    &= \sqrt{v_0^2 - 2gR(1-\cos\theta)}  \\
          &= \sqrt{v_0^2 - 4gR\sin^2 (\theta/2)} .
\end{align*}

Compare this expression for the pendulum's speed with the equal time motion (\ref{Eq:PropSpeed}) 
\[
    v_P  = \omega_0 \sqrt{(R+a_0)^2 - 4a_0R\sin^2(\theta/2)}
\]
about the point $(0,a_0)$. Our goal is to solve for $a_0$ to make the motions identical.

The motions are identical if
\[
     v_0^2 = \omega_0^2 (R+a_0)^2  
\]
and
\[
      4gR = 4\omega_0^2 Ra_0 .
\]
Or if
\[
    \frac{4gR}{v_0^2}    = \frac{4Ra_0}{(R+a_0)^2}      .
\]
Subtracting both sides from one give
\[
         \frac{v_0^2 - 4gR}{v_0^2} =  = \frac{(R - a_0)^2}{(R+a_0)^2)}  .
\]
Now assume the pendulum revolves. Then the pendulum's speed at the top is
\[
      v_1^2 = v_0^2 - 4gR 
\]
and
\[
    \frac{v_1}{v_2} = \frac{R-a_0}{R+a_0} .
\]
Now interpret what this means geometrically.



\section*{Isochronous Families}

\begin{exploration}

Given $\lambda$, $0 < \lambda < 1/2$, find the center and radius of the envelope of the family of $\lambda$-chords. 

\pskip

Let $(0,a)$ be the circle's center and $r$ its radius.

Let $\phi$ be the angle the first iscochronous chord (with one endpoint $(0,-R)$) makes with the vertical. Then
\[
      \phi = \pi/2 - \text{am}(\lambda T) ,
\]
where
\[
  T = \int_0^{\pi} \frac{du}{\sqrt{1-k^2\sin^2 u}}
\] 
is the period of revolution.

Then because the first chord is tangent to the envelope,
\[
     r = (R+a) \sin \phi
\]
And because the envelope belongs to the hyperbolic family generated by the motion,
\[
  \frac{4Ra}{(R+a)^2 - r^2} = k^2 .
\]

Substituting and some algebra leads to a quadratic equation in $a$ with roots
\[
  a =   R \sec \phi \left( \frac{2}{k^2} \sec \phi - \cos\phi \pm   \frac{2}{u} \sqrt{\frac{\sec^2\phi}{k^2} - 1}   \right) .
\]

We choose the minus sign because the plus sign gives the center of the circle in the upper half of the hyperbolic family (the circle that lies outside the pendulum circle.)



\begin{onlineOnly}
    \begin{center}
\desmos{svb8pwijet}{450}{600}  
\end{center}
\end{onlineOnly}

\href{https://www.desmos.com/calculator/svb8pwijet}{Jacobi Elliptic Functions and Theta Functions v 2}

But we should not ignore the other root. It gives the $y$-coordinate of the center of the circle in the other half of the hyperbolic family for an opposite motion with pendulum points starting at $(0,-R)$ and $(R\sin(2\phi),R\cos(2\phi))$. See the demo below.

\begin{onlineOnly}
    \begin{center}
\desmos{swzgtt3nup}{450}{600}  
\end{center}
\end{onlineOnly}

\href{https://www.desmos.com/calculator/swzgtt3nup}{Pendulum Motions Direct and Opposite}


\end{exploration}






\section*{Jacobi Closure Formulas}

The polygonal path closes when the time subtended by the chords is a rational multiple $\lambda$ of the period. The gives the euqation
\[
     \int_0^{\arccos(\frac{r}{R+a})} \frac{du}{(R+a)^2 - r^2 - 4a\sin^2(u/2)} = \lambda \int_0^{2\pi} \frac{du}{(R+a)^2 - r^2 - 4a\sin^2(u/2)} .
\]
Taking $R=1$ gives a relation between $a$ and $r$. We can use desmos to graph these curves as below. But it's hard to see how to use this to get a relation, even when $\lambda=1/3$ (triangle) or $\lambda  = 1/4$ (quadrilateral).


\begin{onlineOnly}
    \begin{center}
\desmos{wnef0tpllt}{450}{600}  
\end{center}
\end{onlineOnly}

\href{https://www.desmos.com/calculator/wnef0tpllt}{Jacobi Formula}



\section*{Revolving Pendulums}

We know the speed
\begin{align*}
    v_P &= \sqrt{v_0^2-4Rg \sin^2 (\theta/2)}  \\
           &=v_0 \sqrt{1-\frac{4Rg}{v_0^2} \sin^2 (\theta/2)} .
\end{align*}

Want to show that 
\[
    v_P = \frac{v_0}{R+a} \cdot \rho ,
\]
ie. that the speed is proportional to the distance $\rho = AP$ from $P$ to the focus. The constant of proportionality
\[
           \omega_0 = \frac{v_0}{R+a}
\]
is the rotation rate of chord $AP$ when it (the chord) is vertical.

Write the above product as
\begin{align*}
   \frac{v_0}{R+a} \cdot \rho  &= \frac{v_0}{R+a} \sqrt{R^2 + a^2 + 2aR \cos\theta} \\
                                         &= v_0 \sqrt{1 - \frac{4aR}{(R+a)^2} \sin^2 (\theta/2)} .
\end{align*}

This is all we need because remember that the focal distance $a$ was defined by the equality
\[
   \frac{4aR}{(R+a)^2} = \frac{4Rg}{v_0^2} .
\]

And since the speed of $P$ is also
\[
  v_P = \omega_P (\rho \sec\alpha)  = \omega_0 \rho , 
\]
where $\omega_P$ is the rotation rate of the chord and $\alpha$ is the angle between the radius $OP$ and segment $AP$, this tells us that
\begin{align*}
\omega_P &= \omega_0  \cos  \alpha  \\
                &= \omega_0 (R\cos \alpha) / R \\
                & = \left( \frac{\omega_0}{R} \right) \rho^\prime ,
\end{align*}
where $\rho^\prime$ is the length of chord $PP^\prime$. So the rotation rate of chord $PP^\prime$ is proportional to its length. The pendulum speed $v_P$ is proportional to $\rho = AP$.


\section{Coaxal Families}
One of my favorite precalculus problems is to find an equation of the line through the intersection points of two circles.


\section{Oscillating Pendulums}

\begin{exploration}
A simple pendulum oscillates as shown below. How can we construct other chords of the arc $AB$ that subtend the same time as chord $\overline{XY}$. What can we say about the envelope of all such chords?

\begin{onlineOnly}
    \begin{center}
\desmos{pleca0vkjw}{450}{600}  
\end{center}
\end{onlineOnly}

\href{https://www.desmos.com/calculator/pleca0vkjw}{Oscillating Pendulum}

\end{exploration}

This belongs earlier, but the focal points of the hypberbolic family generated by the pendulum motion with shape $k$ are the roots of the equation
\[
      \frac{4Rg}{(a+R)^2} = \frac{4Rg}{v_0^2} = k^2.
\]
The roots are
\[
      a = R \left(\frac{2}{k^2} -1  \pm \frac{2}{k}\sqrt{\frac{1}{k^2}-1} \right) . 
\]

With launch speed
\[
   v_0 < 2\sqrt{Rg}
\]
from stable equilibrium, the pendulum reaches a maximum angle $\theta_0$ where 
\[
    v_0^2 = 2Rg(1-\cos\theta_0) = 4Rg\sin^2 (\theta_0)/2 .
\]

The pendulum has no focal point (at least not the way we defined it for revolving pendulums) and the quadratic equation that defined the focal length 
\[
     g(a+R)^2 = v_0^2 a = 4Rag\sin^2 (\theta_0/2) .
\]
has complex roots
\[
     a = -R(\cos \theta_0 \pm i \sin \theta_0).
\]

We start by interpreting the expression
\[
       R^2 + a^2 + 2aR\cos\theta.
\]


It is still true, as for revolving pendulums, that
\[
  \rho = 
\]


\section*{Colliding Pendulums}
Instead of tracking the chords between two points moving in the same direction around a pendulum, send the points in opposite directions. The same logic shows that the lines between these points are tangent to a circle ${\cal C}_1$, now  in the outer half of the coaxal family generated by the motion. Let this circle have center $(0,a)$ and radius $r$.

Let one of the two collision points $P$ have displacement angle $\theta$ with coordinates $(R\sin\theta, -R \cos\theta)$. The tangent to the pendulum path at $P$ has equation
\[
       x\sin \theta - y\cos\theta - R = 0.
\]

The center $(0,a)$ and radius $r$ of ${\cal C}_1$ satisfy two conditions:

\pskip

(1) Since ${\cal C}_1$ is in the hyperbolic family generated by the motion with shape $k$,
\[
      4ar = k^2 \left(  (R+a)^2 - r^2   \right)
\]

\pskip

(2) Since the distance from $(0,a)$ to the tangent line at $P$ is $r$, 
\[
     \Big|  -y \cos \theta - R  \Big| = r .
\] 

These two conditions give a quadratic equation in $a$, with one solution $a=0$ (with corresponding radius $r=R$, ie the pendulum path). The other solution, the one of interest, is
\[
     a = \frac{4R}{k^2} \left( 1 - k^2 \sin^2 (\theta/2)    \right) ,
\]
with corresponding radius
\[
  r = R + a\cos \theta .
\]

The motions are illustrated below. For the same reasons as before, the rotation rate of the chord is proportional to its length and the speeds of the two motions are proportional to their respective distances to the points of tangency.

\begin{onlineOnly}
    \begin{center}
\desmos{5vecnkcwou}{450}{600}  
\end{center}
\end{onlineOnly}

\href{https://www.desmos.com/calculator/5vecnkcwou}{Revolving Pendulum Pairs of Points}


\section*{Asymptotic Pendulums}

\end{document}